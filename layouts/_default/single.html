{{- define "main" }}
<article>
  <nav class="breadcrumb" aria-label="Breadcrumb">
    <a href="/">Home</a>
    {{- range .Ancestors.Reverse }}
      {{- if not .IsHome }}
        / <a href="{{ .RelPermalink }}">{{ .LinkTitle }}</a>
      {{- end }}
    {{- end }}
    / <span aria-current="page">{{ .LinkTitle }}</span>
  </nav>

  <header>
    <h1>{{ .Title }}</h1>
    {{- with .Params.subtitle }}<p class="subtitle">{{ . }}</p>{{- end }}
    <div class="meta">
      <div class="taxonomy-date">
        {{ partial "date.html" . }}
      </div>

      {{- with .GetTerms "categorias" }}
        <div class="taxonomy-categories">
          Categorias:
          {{- range $i, $term := . }}
            {{- if $i }}, {{ end }}
            {{ with $term.Params.emoji }}{{ . }}&nbsp;{{ end }}<a href="{{ $term.RelPermalink }}">{{ $term.LinkTitle }}</a>
          {{- end }}
        </div>
      {{- end }}

      {{- with .GetTerms "tags" }}
        <div class="taxonomy-tags">
          Tags:
          {{- range $i, $term := . }}
            {{- if $i }}, {{ end }}
            <a href="{{ $term.RelPermalink }}">{{ $term.LinkTitle }}</a>
          {{- end }}
        </div>
      {{- end }}

      {{- with .GetTerms "series" }}
        <div class="taxonomy-series">
          Série:
          {{- range $i, $term := . }}
            {{- if $i }}, {{ end }}
            <a href="{{ $term.RelPermalink }}">{{ $term.LinkTitle }}</a>{{ with $.Params.part }} (Parte {{ . }}){{ end }}
          {{- end }}
        </div>
      {{- end }}
    </div>
  </header>

  {{- if and .Params.toc (gt (len .TableOfContents) 50) }}
    <aside class="toc">
      <h2>Sumário</h2>
      <nav id="TableOfContents">
        {{ .TableOfContents }}
      </nav>
    </aside>
  {{- end }}

  <div class="content">
    {{ .Content }}
  </div>

  {{- range .GetTerms "series" }}
    {{- if gt (len .Pages) 1 }}
      <aside class="series-nav">
        <h3>Mais de {{ .LinkTitle }}</h3>
        <ul>
          {{- range .Pages }}
          <li{{ if eq .Permalink $.Permalink }} class="active"{{ end }}>
            {{- if eq .Permalink $.Permalink }}
              <span>{{ .LinkTitle }}{{ with .Params.part }} (Parte {{ . }}){{ end }}</span>
            {{- else }}
              <a href="{{ .RelPermalink }}">{{ .LinkTitle }}</a>{{ with .Params.part }} (Parte {{ . }}){{ end }}
            {{- end }}
          </li>
          {{- end }}
        </ul>
      </aside>
    {{- end }}
  {{- end }}

  <footer class="post-footer">
    <nav>
      <a href="/">&larr; Home</a>
      {{- with .CurrentSection }}
        {{- if not .IsHome }}
          <a href="{{ .RelPermalink }}">Mais {{ .LinkTitle | lower }} &rarr;</a>
        {{- end }}
      {{- end }}
    </nav>
  </footer>

</article>
{{- end }}